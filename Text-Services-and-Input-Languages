#
# Remove and create 'HKCU\Keyboard Layout\Substitutes'
#
  remove-item        -path 'HKCU:\Keyboard Layout\Substitutes'
  $eatMe = new-item  -path 'HKCU:\Keyboard Layout\Substitutes'

#
# Remove HKCU\Keyboard Laoyout\Preload
#   Strangly, this remove-item does not seem to entirely remove
#   the specified key:
#
  remove-item        -path 'HKCU:\Keyboard Layout\Preload'

#
# Add layouts
#
  new-itemProperty -path 'HKCU:\Keyboard Layout\Preload' -name  1 -value ('0000' + '0409') # US
  new-itemProperty -path 'HKCU:\Keyboard Layout\Preload' -name  2 -value ('0000' + '0807') # German (Switzerland)


#
# Language Bar
#
  $eatMe = new-itemProperty -path 'HKCU:\Software\Microsoft\CTF\LangBar' -name  ShowStatus             -value 4  -propertyType DWord -force   # Docked in the taskbar
  $eatMe = new-itemProperty -path 'HKCU:\Software\Microsoft\CTF\LangBar' -name  Label                  -value 1  -propertyType DWord -force   # Show text labels on the Language Bar
  $eatMe = new-itemProperty -path 'HKCU:\Software\Microsoft\CTF\LangBar' -name  ExtraIconsOnMinimized  -value 0  -propertyType DWord -force   # Don't »Show additional Language bar icons in the taskbar«

#
# Hotkeys to switch between keyboard layouts
#

  $mod_leftAlt = 0x01
  $VK_0        = 0x30
  $VK_9        = 0x39

  $valKeyModifiers      = [byte[]]( $mod_leftAlt , 0xc0 , 0x00 , 0x00 )
  $valLayoutUS          = [byte[]](         0x09 , 0x04 , 0x09 , 0x04 )
  $valLayoutSwissGerman = [byte[]](         0x07 , 0x08 , 0x07 , 0x08 )
  $valVK_0              = [byte[]](        $VK_0 , 0x00 , 0x00 , 0x00 )
  $valVK_9              = [byte[]](        $VK_9 , 0x00 , 0x00 , 0x00 )
 
  remove-item        -path 'HKCU:\Control Panel\Input Method\Hot Keys\00000100'
  remove-item        -path 'HKCU:\Control Panel\Input Method\Hot Keys\00000101'
  $eatMe = new-item  -path 'HKCU:\Control Panel\Input Method\Hot Keys\00000100'
  $eatMe = new-item  -path 'HKCU:\Control Panel\Input Method\Hot Keys\00000101'

  $eatMe = new-itemProperty -path 'HKCU:\Control Panel\Input Method\Hot Keys\00000100' -name 'Virtual KEY'   -value $valVK_9                 -propertyType binary
  $eatMe = new-itemProperty -path 'HKCU:\Control Panel\Input Method\Hot Keys\00000100' -name 'Key Modifiers' -value $valKeyModifiers         -propertyType binary
  $eatMe = new-itemProperty -path 'HKCU:\Control Panel\Input Method\Hot Keys\00000100' -name 'Target IME'    -value $valLayoutUS             -propertyType binary

  $eatMe = new-itemProperty -path 'HKCU:\Control Panel\Input Method\Hot Keys\00000101' -name 'Virtual KEY'   -value $valVK_0                 -propertyType binary
  $eatMe = new-itemProperty -path 'HKCU:\Control Panel\Input Method\Hot Keys\00000101' -name 'Key Modifiers' -value $valKeyModifiers         -propertyType binary
  $eatMe = new-itemProperty -path 'HKCU:\Control Panel\Input Method\Hot Keys\00000101' -name 'Target IME'    -value $valLayoutSwissGerman    -propertyType binary
